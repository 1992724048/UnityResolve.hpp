// Mono 运行时 64 位内存布局（GameObjectManager 与 GameObject 相关结构）
// 所有偏移均为字节偏移，从结构体起始地址算起

// UnityPlayer.dll + GameObjectManagerOffset -> GameObjectManager
struct MonoGameObjectNode {
    MonoGameObjectNode* pLast;        // 0x00  前一个节点
    MonoGameObjectNode* pNext;        // 0x08  后一个节点
    void*               nativeObject; // 0x10  原生 GameObject 指针 -> MonoNativeGameObject*
};

struct MonoGameObjectManager {
    char                pad_0000[0x28]; // 0x00  保留
    MonoGameObjectNode* firstNode;      // 0x28  链表头节点
};

struct MonoNativeGameObject {
    char   pad_0000[0x28];      // 0x00  保留
    void*  managedObject;       // 0x28  托管对象指针 -> MonoManagedGameObject*
    void*  componentPool;       // 0x30  组件池指针 -> MonoComponentPool*
    char   pad_0038[0x8];       // 0x38  保留
    int    componentCount;      // 0x40  组件数量
    char   pad_0044[0x1C];      // 0x44  保留
    void*  objectName;          // 0x60  名称字符串指针
};

struct MonoComponentPool {
    char   pad_0000[0x8];       // 0x00  保留
    void*  firstComponent;      // 0x08  第一个组件指针 -> MonoNativeComponent*
    // 后续组件地址：0x18, 0x28, ... 步长 0x10
};

struct MonoNativeComponent {
    char   pad_0000[0x28];      // 0x00  保留
    void*  managedComponent;    // 0x28  托管组件指针 -> MonoManagedComponent*
};

// Mono 托管对象虚表
struct MonoVTableInternal {
    void* klass;    // 0x00  类元数据指针 -> MonoClassInternal*
};

// Mono 类元数据布局（用于获取类型信息）
struct MonoClassInternal {
    char        pad_0000[0x48]; // 0x00  保留
    const char* name;           // 0x48  类名
    const char* namespaze;      // 0x50  命名空间
};

// Mono 托管对象头部
struct MonoManagedObjectHeader {
    MonoVTableInternal* vtable;  // 0x00  虚表指针
    void*               monitor; // 0x08  同步锁
};

struct MonoManagedGameObject : MonoManagedObjectHeader {
    void* nativeObject; // 0x10  原生对象指针 -> MonoNativeGameObject*
};

struct MonoManagedComponent : MonoManagedObjectHeader {
    void* nativeObject; // 0x10  原生组件指针 -> MonoNativeComponent*
};